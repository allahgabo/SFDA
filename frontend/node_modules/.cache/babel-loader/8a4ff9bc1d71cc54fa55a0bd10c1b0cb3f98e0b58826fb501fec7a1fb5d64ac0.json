{"ast":null,"code":"const getToken = () => localStorage.getItem('sfda_token') || '';\n\n/**\n * Downloads a PDF with auth token injected into the fetch request.\n */\nexport async function downloadPDF(reportId, filename = null) {\n  const saveName = filename || `SFDA_Report_${reportId}.pdf`;\n  try {\n    const res = await fetch(`/api/reports/${reportId}/pdf/`, {\n      headers: {\n        'Authorization': `Token ${getToken()}`\n      }\n    });\n    if (!res.ok) throw new Error(`Server returned ${res.status}: ${await res.text()}`);\n    const blob = await res.blob();\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = saveName;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    setTimeout(() => URL.revokeObjectURL(url), 10000);\n  } catch (err) {\n    console.error('PDF download error:', err);\n    alert(`Could not download PDF: ${err.message}`);\n  }\n}\n\n/**\n * Fetches an HTML preview with auth token, returns a blob: URL safe for iframe src.\n * Call revokePreviewUrl(url) when the modal closes.\n */\nexport async function fetchPreviewBlobUrl(reportId) {\n  const res = await fetch(`/api/reports/${reportId}/preview/`, {\n    headers: {\n      'Authorization': `Token ${getToken()}`\n    }\n  });\n  if (!res.ok) throw new Error(`Preview failed: ${res.status}`);\n  const html = await res.text();\n  const blob = new Blob([html], {\n    type: 'text/html; charset=utf-8'\n  });\n  return URL.createObjectURL(blob);\n}\nexport function revokePreviewUrl(url) {\n  if (url !== null && url !== void 0 && url.startsWith('blob:')) URL.revokeObjectURL(url);\n}","map":{"version":3,"names":["getToken","localStorage","getItem","downloadPDF","reportId","filename","saveName","res","fetch","headers","ok","Error","status","text","blob","url","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","removeChild","setTimeout","revokeObjectURL","err","console","error","alert","message","fetchPreviewBlobUrl","html","Blob","type","revokePreviewUrl","startsWith"],"sources":["D:/New Project/milken_app/frontend/src/utils/downloadPDF.js"],"sourcesContent":["const getToken = () => localStorage.getItem('sfda_token') || '';\n\n/**\n * Downloads a PDF with auth token injected into the fetch request.\n */\nexport async function downloadPDF(reportId, filename = null) {\n  const saveName = filename || `SFDA_Report_${reportId}.pdf`;\n  try {\n    const res = await fetch(`/api/reports/${reportId}/pdf/`, {\n      headers: { 'Authorization': `Token ${getToken()}` },\n    });\n    if (!res.ok) throw new Error(`Server returned ${res.status}: ${await res.text()}`);\n    const blob = await res.blob();\n    const url  = URL.createObjectURL(blob);\n    const a    = document.createElement('a');\n    a.href = url; a.download = saveName;\n    document.body.appendChild(a); a.click(); document.body.removeChild(a);\n    setTimeout(() => URL.revokeObjectURL(url), 10000);\n  } catch (err) {\n    console.error('PDF download error:', err);\n    alert(`Could not download PDF: ${err.message}`);\n  }\n}\n\n/**\n * Fetches an HTML preview with auth token, returns a blob: URL safe for iframe src.\n * Call revokePreviewUrl(url) when the modal closes.\n */\nexport async function fetchPreviewBlobUrl(reportId) {\n  const res = await fetch(`/api/reports/${reportId}/preview/`, {\n    headers: { 'Authorization': `Token ${getToken()}` },\n  });\n  if (!res.ok) throw new Error(`Preview failed: ${res.status}`);\n  const html = await res.text();\n  const blob = new Blob([html], { type: 'text/html; charset=utf-8' });\n  return URL.createObjectURL(blob);\n}\n\nexport function revokePreviewUrl(url) {\n  if (url?.startsWith('blob:')) URL.revokeObjectURL(url);\n}\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGA,CAAA,KAAMC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE;;AAE/D;AACA;AACA;AACA,OAAO,eAAeC,WAAWA,CAACC,QAAQ,EAAEC,QAAQ,GAAG,IAAI,EAAE;EAC3D,MAAMC,QAAQ,GAAGD,QAAQ,IAAI,eAAeD,QAAQ,MAAM;EAC1D,IAAI;IACF,MAAMG,GAAG,GAAG,MAAMC,KAAK,CAAC,gBAAgBJ,QAAQ,OAAO,EAAE;MACvDK,OAAO,EAAE;QAAE,eAAe,EAAE,SAAST,QAAQ,CAAC,CAAC;MAAG;IACpD,CAAC,CAAC;IACF,IAAI,CAACO,GAAG,CAACG,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,mBAAmBJ,GAAG,CAACK,MAAM,KAAK,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC,EAAE,CAAC;IAClF,MAAMC,IAAI,GAAG,MAAMP,GAAG,CAACO,IAAI,CAAC,CAAC;IAC7B,MAAMC,GAAG,GAAIC,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC;IACtC,MAAMI,CAAC,GAAMC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACxCF,CAAC,CAACG,IAAI,GAAGN,GAAG;IAAEG,CAAC,CAACI,QAAQ,GAAGhB,QAAQ;IACnCa,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,CAAC,CAAC;IAAEA,CAAC,CAACO,KAAK,CAAC,CAAC;IAAEN,QAAQ,CAACI,IAAI,CAACG,WAAW,CAACR,CAAC,CAAC;IACrES,UAAU,CAAC,MAAMX,GAAG,CAACY,eAAe,CAACb,GAAG,CAAC,EAAE,KAAK,CAAC;EACnD,CAAC,CAAC,OAAOc,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEF,GAAG,CAAC;IACzCG,KAAK,CAAC,2BAA2BH,GAAG,CAACI,OAAO,EAAE,CAAC;EACjD;AACF;;AAEA;AACA;AACA;AACA;AACA,OAAO,eAAeC,mBAAmBA,CAAC9B,QAAQ,EAAE;EAClD,MAAMG,GAAG,GAAG,MAAMC,KAAK,CAAC,gBAAgBJ,QAAQ,WAAW,EAAE;IAC3DK,OAAO,EAAE;MAAE,eAAe,EAAE,SAAST,QAAQ,CAAC,CAAC;IAAG;EACpD,CAAC,CAAC;EACF,IAAI,CAACO,GAAG,CAACG,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,mBAAmBJ,GAAG,CAACK,MAAM,EAAE,CAAC;EAC7D,MAAMuB,IAAI,GAAG,MAAM5B,GAAG,CAACM,IAAI,CAAC,CAAC;EAC7B,MAAMC,IAAI,GAAG,IAAIsB,IAAI,CAAC,CAACD,IAAI,CAAC,EAAE;IAAEE,IAAI,EAAE;EAA2B,CAAC,CAAC;EACnE,OAAOrB,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC;AAClC;AAEA,OAAO,SAASwB,gBAAgBA,CAACvB,GAAG,EAAE;EACpC,IAAIA,GAAG,aAAHA,GAAG,eAAHA,GAAG,CAAEwB,UAAU,CAAC,OAAO,CAAC,EAAEvB,GAAG,CAACY,eAAe,CAACb,GAAG,CAAC;AACxD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}