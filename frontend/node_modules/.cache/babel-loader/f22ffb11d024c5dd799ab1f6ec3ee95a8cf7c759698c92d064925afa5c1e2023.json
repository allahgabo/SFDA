{"ast":null,"code":"const getToken=()=>localStorage.getItem('sfda_token')||'';/**\n * Downloads a PDF with auth token injected into the fetch request.\n */export async function downloadPDF(reportId){let filename=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const saveName=filename||\"SFDA_Report_\".concat(reportId,\".pdf\");try{const res=await fetch(\"/api/reports/\".concat(reportId,\"/pdf/\"),{headers:{'Authorization':\"Token \".concat(getToken())}});if(!res.ok)throw new Error(\"Server returned \".concat(res.status,\": \").concat(await res.text()));const blob=await res.blob();const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=saveName;document.body.appendChild(a);a.click();document.body.removeChild(a);setTimeout(()=>URL.revokeObjectURL(url),10000);}catch(err){console.error('PDF download error:',err);alert(\"Could not download PDF: \".concat(err.message));}}/**\n * Fetches an HTML preview with auth token, returns a blob: URL safe for iframe src.\n * Call revokePreviewUrl(url) when the modal closes.\n */export async function fetchPreviewBlobUrl(reportId){const res=await fetch(\"/api/reports/\".concat(reportId,\"/preview/\"),{headers:{'Authorization':\"Token \".concat(getToken())}});if(!res.ok)throw new Error(\"Preview failed: \".concat(res.status));const html=await res.text();const blob=new Blob([html],{type:'text/html; charset=utf-8'});return URL.createObjectURL(blob);}export function revokePreviewUrl(url){if(url!==null&&url!==void 0&&url.startsWith('blob:'))URL.revokeObjectURL(url);}","map":{"version":3,"names":["getToken","localStorage","getItem","downloadPDF","reportId","filename","arguments","length","undefined","saveName","concat","res","fetch","headers","ok","Error","status","text","blob","url","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","removeChild","setTimeout","revokeObjectURL","err","console","error","alert","message","fetchPreviewBlobUrl","html","Blob","type","revokePreviewUrl","startsWith"],"sources":["D:/New Project/milken_app/frontend/src/utils/downloadPDF.js"],"sourcesContent":["const getToken = () => localStorage.getItem('sfda_token') || '';\n\n/**\n * Downloads a PDF with auth token injected into the fetch request.\n */\nexport async function downloadPDF(reportId, filename = null) {\n  const saveName = filename || `SFDA_Report_${reportId}.pdf`;\n  try {\n    const res = await fetch(`/api/reports/${reportId}/pdf/`, {\n      headers: { 'Authorization': `Token ${getToken()}` },\n    });\n    if (!res.ok) throw new Error(`Server returned ${res.status}: ${await res.text()}`);\n    const blob = await res.blob();\n    const url  = URL.createObjectURL(blob);\n    const a    = document.createElement('a');\n    a.href = url; a.download = saveName;\n    document.body.appendChild(a); a.click(); document.body.removeChild(a);\n    setTimeout(() => URL.revokeObjectURL(url), 10000);\n  } catch (err) {\n    console.error('PDF download error:', err);\n    alert(`Could not download PDF: ${err.message}`);\n  }\n}\n\n/**\n * Fetches an HTML preview with auth token, returns a blob: URL safe for iframe src.\n * Call revokePreviewUrl(url) when the modal closes.\n */\nexport async function fetchPreviewBlobUrl(reportId) {\n  const res = await fetch(`/api/reports/${reportId}/preview/`, {\n    headers: { 'Authorization': `Token ${getToken()}` },\n  });\n  if (!res.ok) throw new Error(`Preview failed: ${res.status}`);\n  const html = await res.text();\n  const blob = new Blob([html], { type: 'text/html; charset=utf-8' });\n  return URL.createObjectURL(blob);\n}\n\nexport function revokePreviewUrl(url) {\n  if (url?.startsWith('blob:')) URL.revokeObjectURL(url);\n}\n"],"mappings":"AAAA,KAAM,CAAAA,QAAQ,CAAGA,CAAA,GAAMC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,EAAI,EAAE,CAE/D;AACA;AACA,GACA,MAAO,eAAe,CAAAC,WAAWA,CAACC,QAAQ,CAAmB,IAAjB,CAAAC,QAAQ,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,CACzD,KAAM,CAAAG,QAAQ,CAAGJ,QAAQ,iBAAAK,MAAA,CAAmBN,QAAQ,QAAM,CAC1D,GAAI,CACF,KAAM,CAAAO,GAAG,CAAG,KAAM,CAAAC,KAAK,iBAAAF,MAAA,CAAiBN,QAAQ,UAAS,CACvDS,OAAO,CAAE,CAAE,eAAe,UAAAH,MAAA,CAAWV,QAAQ,CAAC,CAAC,CAAG,CACpD,CAAC,CAAC,CACF,GAAI,CAACW,GAAG,CAACG,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,oBAAAL,MAAA,CAAoBC,GAAG,CAACK,MAAM,OAAAN,MAAA,CAAK,KAAM,CAAAC,GAAG,CAACM,IAAI,CAAC,CAAC,CAAE,CAAC,CAClF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAP,GAAG,CAACO,IAAI,CAAC,CAAC,CAC7B,KAAM,CAAAC,GAAG,CAAIC,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC,CACtC,KAAM,CAAAI,CAAC,CAAMC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,CAAC,CAACG,IAAI,CAAGN,GAAG,CAAEG,CAAC,CAACI,QAAQ,CAAGjB,QAAQ,CACnCc,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,CAAC,CAAC,CAAEA,CAAC,CAACO,KAAK,CAAC,CAAC,CAAEN,QAAQ,CAACI,IAAI,CAACG,WAAW,CAACR,CAAC,CAAC,CACrES,UAAU,CAAC,IAAMX,GAAG,CAACY,eAAe,CAACb,GAAG,CAAC,CAAE,KAAK,CAAC,CACnD,CAAE,MAAOc,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,qBAAqB,CAAEF,GAAG,CAAC,CACzCG,KAAK,4BAAA1B,MAAA,CAA4BuB,GAAG,CAACI,OAAO,CAAE,CAAC,CACjD,CACF,CAEA;AACA;AACA;AACA,GACA,MAAO,eAAe,CAAAC,mBAAmBA,CAAClC,QAAQ,CAAE,CAClD,KAAM,CAAAO,GAAG,CAAG,KAAM,CAAAC,KAAK,iBAAAF,MAAA,CAAiBN,QAAQ,cAAa,CAC3DS,OAAO,CAAE,CAAE,eAAe,UAAAH,MAAA,CAAWV,QAAQ,CAAC,CAAC,CAAG,CACpD,CAAC,CAAC,CACF,GAAI,CAACW,GAAG,CAACG,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,oBAAAL,MAAA,CAAoBC,GAAG,CAACK,MAAM,CAAE,CAAC,CAC7D,KAAM,CAAAuB,IAAI,CAAG,KAAM,CAAA5B,GAAG,CAACM,IAAI,CAAC,CAAC,CAC7B,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAsB,IAAI,CAAC,CAACD,IAAI,CAAC,CAAE,CAAEE,IAAI,CAAE,0BAA2B,CAAC,CAAC,CACnE,MAAO,CAAArB,GAAG,CAACC,eAAe,CAACH,IAAI,CAAC,CAClC,CAEA,MAAO,SAAS,CAAAwB,gBAAgBA,CAACvB,GAAG,CAAE,CACpC,GAAIA,GAAG,SAAHA,GAAG,WAAHA,GAAG,CAAEwB,UAAU,CAAC,OAAO,CAAC,CAAEvB,GAAG,CAACY,eAAe,CAACb,GAAG,CAAC,CACxD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}